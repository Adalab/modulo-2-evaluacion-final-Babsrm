"use strict";const searchBtn=document.querySelector(".js-searchBtn"),resetBtn=document.querySelector(".js-resetBtn"),resetBtnFav=document.querySelector(".js-resetBtnfav"),listaFavs=document.querySelector(".js-favlistcontainer"),resultsForDlt=document.querySelector(".js-resultsData");let addFav=[];const apiURL="https://api.jikan.moe/v3/search/anime?q=",imgIfNone="https://via.placeholder.com/227x320/e5e5e5/666/?text=TV";let textInput="",serieList=[],favorites=[];function handleResetBtn(){textInput="",serieList=[],favorites=[],listaFavs.innerHTML="",resultsForDlt.innerHTML="",rmvFavsFromLocalStg()}function callApi(){fetch(`${apiURL}${textInput}`).then(e=>e.json()).then(e=>{serieList=e.results,getSeriesResult()})}function handleSearchBtn(e){e.preventDefault(),textInput=document.querySelector(".js-userInput").value,callApi()}function getFavsFromLocalStg(){const e=JSON.parse(localStorage.getItem("favorites"));e&&(favorites=e)}function saveFavsLocalStg(){favorites.length>0?localStorage.setItem("favorites",JSON.stringify(favorites)):rmvFavsFromLocalStg()}function rmvFavsFromLocalStg(){localStorage.removeItem("favorites")}function getSeriesResult(){const e=document.querySelector(".js-resultsData");e.textContent="",serieList.length>0&&getDataFromApi(e,"Resultados",serieList)}function getDataFromApi(e,t,n){const s=getTitle(t),a=getList();for(const e of n){const t=getListItemFromApi(e),n=getImageFromApi(e),s=getSecondTitleFromApi(e);t.appendChild(n),t.appendChild(s),a.appendChild(t)}e.appendChild(s),e.appendChild(a),addFav=document.querySelectorAll(".ulSerie");for(let e of addFav)e.addEventListener("click",handleFavBtn)}function getTitle(e){const t=document.createElement("h5");return t.className="ulSerie__title",t.textContent=e,t}function getList(){const e=document.createElement("ul");return e.className="results__results",e}function getListItemFromApi(e){const t=document.createElement("li");return t.dataset.id=e.mal_id,t.className="ulSerie",t}function getImageFromApi(e){const t=document.createElement("img");return t.className="urlImg",t.src=e.image_url,t}function getSecondTitleFromApi(e){const t=document.createElement("h6");t.className="secondTitle";const n=document.createTextNode(e.title);return t.appendChild(n),t}function handleFavBtn(e){e.preventDefault(),showFavs(e),getInfoFromFavs(),saveFavsLocalStg()}function showFavs(e){const t=parseInt(e.currentTarget.dataset.id),n=serieList.find(e=>e.mal_id===t);favorites.push(n)}function getInfoFromFavs(){listaFavs.innerHTML="";for(const e of favorites){const t=getListItemFromApi(e),n=getImageFromApi(e),s=getSecondTitleFromApi(e);listaFavs.appendChild(n),listaFavs.appendChild(s),listaFavs.appendChild(t)}}resetBtn.addEventListener("click",handleResetBtn),searchBtn.addEventListener("click",handleSearchBtn),resetBtnFav.addEventListener("click",rmvFavsFromLocalStg),getFavsFromLocalStg(),saveFavsLocalStg();